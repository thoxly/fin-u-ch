# Обновление компонента Select

## Изменения

### 1. Проблема с дубликатом "+"

**Исправлено:** Убран дубликат символа "+" в компоненте Select

- **Было:** В label опции создания был текст "+ Добавить новый", а компонент Select добавлял еще одну иконку PlusIcon
- **Стало:** Убран текст "+ Добавить новый" из label, используется только иконка в новом UI

### 2. Новый UI для выбора и создания

**Добавлено:** Строка поиска с кнопкой "+" справа

- **Было:** Отдельная строка "+ Добавить новый" в списке опций
- **Стало:**
  - Строка поиска с иконкой лупы слева
  - Кнопка "+" справа от поиска для создания нового элемента
  - Фильтрация опций по поисковому запросу
  - Автофокус на поле поиска при открытии

### 3. Новый API компонента Select

#### Добавлен prop `onCreateNew`

```typescript
interface SelectProps {
  // ... существующие props
  onCreateNew?: () => void; // Callback для создания нового элемента
}
```

#### Убрана необходимость в опции `__create__`

**Было:**

```typescript
<Select
  value={value}
  onChange={(value) => {
    if (value === '__create__') {
      // Открыть модалку создания
    } else {
      // Обычная логика
    }
  }}
  options={[
    { value: '__create__', label: '+ Добавить новый' },
    { value: '', label: 'Не выбрано' },
    ...items.map(item => ({ value: item.id, label: item.name }))
  ]}
/>
```

**Стало:**

```typescript
<Select
  value={value}
  onChange={(value) => {
    // Только обычная логика, без проверки __create__
  }}
  onCreateNew={() => {
    // Открыть модалку создания
  }}
  options={[
    { value: '', label: 'Не выбрано' },
    ...items.map(item => ({ value: item.id, label: item.name }))
  ]}
/>
```

## Обновленные файлы

### Основной компонент

- `/apps/web/src/shared/ui/Select.tsx` - переработан UI и API

### Использование в импорте банковских операций

- `/apps/web/src/features/bank-import/ImportMappingRow.tsx` - обновлено использование Select
- `/apps/web/src/features/bank-import/MappingRuleDialog.tsx` - обновлено использование Select

### Использование в формах операций

- `/apps/web/src/features/operation-form/OperationBasicInfo.tsx` - обновлено использование Select
- `/apps/web/src/features/operation-form/OperationFinancialParams.tsx` - обновлено использование Select (5 мест)

## Преимущества

1. **Улучшенный UX**: Поиск и создание совмещены в одной строке
2. **Быстрый поиск**: Фильтрация опций по мере ввода
3. **Чистый API**: Явное разделение выбора и создания через отдельный callback
4. **Обратная совместимость**: Если `onCreateNew` не передан, кнопка "+" не отображается
5. **Лучшая видимость**: Кнопка "+" всегда видна и доступна

## Тестирование

Необходимо протестировать:

1. ✅ Импорт банковских операций - выбор контрагента, статьи, счета, сделки, подразделения
2. ✅ Форма операций - выбор валюты, счетов, сделки, подразделения
3. ✅ Правила маппинга - выбор целевого элемента
4. ✅ Поиск работает корректно
5. ✅ Создание нового элемента через кнопку "+"
6. ✅ Фокус на поле поиска при открытии
7. ✅ Закрытие при скролле контейнера
