# Подробная инструкция: Настройка Telegram уведомлений в Uptime Kuma

## Шаг 1: Откройте Uptime Kuma

1. Откройте в браузере: **http://vect-a.ru:3001** или **http://83.166.244.139:3001**
2. Войдите с вашими учетными данными администратора

## Шаг 2: Перейдите в настройки уведомлений

1. В левом меню нажмите на иконку **⚙️ Settings** (или кликните на ваш профиль в правом верхнем углу → **Settings**)
2. В меню слева выберите **Notifications** (или **Уведомления**)

## Шаг 3: Добавьте Telegram уведомление

1. Нажмите кнопку **"+ Add Notification"** (или **"+ Добавить уведомление"**)
2. В списке типов уведомлений выберите **"Telegram"**

## Шаг 4: Заполните данные Telegram бота

Вам понадобятся следующие данные из файла `.env` на сервере:

- **Bot Token**: `8290253710:AAHdLdps92gDublcWjq0DGU_kTagIXlWINg`
- **Chat ID**: `-4964389678`

### Поля для заполнения:

1. **Friendly Name** (Опционально):
   - Введите любое имя, например: "Production Alerts" или "Мониторинг"

2. **Bot Token**:
   - Вставьте: `8290253710:AAHdLdps92gDublcWjq0DGU_kTagIXlWINg`
   - Это токен вашего Telegram бота

3. **Chat ID**:
   - Вставьте: `-4964389678`
   - Это ID чата или группы, куда будут приходить уведомления
   - Отрицательное число означает, что это группа

4. **Parse Mode** (Опционально):
   - Оставьте по умолчанию или выберите "HTML" для форматирования

## Шаг 5: Протестируйте уведомление

1. После заполнения всех полей нажмите кнопку **"Test"** (или **"Тест"**)
2. Проверьте Telegram - вам должно прийти тестовое сообщение от бота
3. Если сообщение пришло - настройка правильная!

## Шаг 6: Сохраните настройки

1. Нажмите кнопку **"Save"** (или **"Сохранить"**)
2. Уведомление будет добавлено в список

## Шаг 7: Настройте уведомления для мониторов

Теперь нужно привязать это уведомление к вашим мониторам:

### Создание монитора:

1. На главной странице нажмите **"+ Add New Monitor"** (или **"+ Добавить новый монитор"**)

2. **Монитор для Frontend:**
   - **Name**: `Frontend - vect-a.ru`
   - **URL**: `https://vect-a.ru/`
   - **Type**: `HTTP(s)`
   - **Interval**: `60 seconds` (или по вашему выбору)
   - В разделе **"Notifications"** выберите созданное Telegram уведомление
   - Нажмите **"Save"**

3. **Монитор для API Health:**
   - **Name**: `API Health Check`
   - **URL**: `https://vect-a.ru/api/health`
   - **Type**: `HTTP(s)`
   - **Interval**: `60 seconds`
   - В разделе **"Notifications"** выберите созданное Telegram уведомление
   - Нажмите **"Save"**

4. **Монитор для Nginx Health:**
   - **Name**: `Nginx Health Check`
   - **URL**: `https://vect-a.ru/health`
   - **Type**: `HTTP(s)`
   - **Interval**: `60 seconds`
   - В разделе **"Notifications"** выберите созданное Telegram уведомление
   - Нажмите **"Save"**

## Дополнительные настройки уведомлений

В настройках уведомления вы можете выбрать:

- **Send only when monitor is down**: Отправлять только когда монитор недоступен
- **Send only when monitor is up**: Отправлять только когда монитор снова доступен
- **Send both**: Отправлять в обоих случаях (рекомендуется)

## Проверка работы

1. После создания мониторов подождите несколько минут
2. Проверьте Telegram - должны прийти уведомления о статусе мониторов
3. Попробуйте временно отключить один из сервисов, чтобы проверить, что уведомления о падении работают

## Troubleshooting

### Проблема: Тестовое сообщение не приходит

1. Проверьте, что Bot Token правильный
2. Проверьте, что Chat ID правильный
3. Для личного чата: отправьте боту `/start` в Telegram
4. Для группы: убедитесь, что бот добавлен в группу и является администратором

### Проблема: Уведомления не приходят для мониторов

1. Проверьте, что уведомление выбрано в настройках монитора
2. Проверьте, что монитор активен (не в режиме паузы)
3. Проверьте логи Uptime Kuma: `docker logs fin-u-ch-uptime-kuma`

### Проблема: Не могу найти настройки уведомлений

1. Убедитесь, что вы вошли как администратор
2. Настройки находятся в: **Settings** → **Notifications**
3. Если не видите этот пункт, проверьте права доступа

## Полезные ссылки

- [Официальная документация Uptime Kuma](https://github.com/louislam/uptime-kuma)
- [Документация по Telegram Bot API](https://core.telegram.org/bots/api)
